# RayTraceVS 使い方ガイド

## 初めての方へ

### 1. サンプルシーンを開く

アプリケーションを起動したら、まずサンプルシーンを開いてみましょう。

1. メニューから **「ファイル」→「開く」** を選択
2. `sample_scene.rtvs` ファイルを選択して開く
3. ノードエディタに以下のノードが表示されます：
   - 球ノード（赤い球体）
   - 平面ノード（床）
   - カメラノード（視点）
   - ライトノード（照明）
   - シーンノード（最終出力）

### 2. レンダリングを実行する

サンプルシーンが読み込まれたら、レイトレーシングを実行します。

1. メニューから **「レンダリング」→「レンダリング開始」** を選択
2. レンダリングウィンドウが開きます
3. ウィンドウ下部の **「開始」** ボタンをクリック
4. レイトレーシングの結果がリアルタイムで表示されます

### 3. レンダリングを停止する

- レンダリングウィンドウの **「停止」** ボタンをクリック
- または、メニューから **「レンダリング」→「レンダリング停止」** を選択
- レンダリングウィンドウを閉じる

## ノードエディタの使い方

### ノードを追加する

1. 左パネルの「コンポーネントパレット」から追加したいノードのボタンをクリック
2. ノードがノードエディタ（中央パネル）に自動的に配置されます

### 使用可能なノード

#### オブジェクトノード
- **球**: 球体オブジェクト
  - プロパティ: 位置、半径、色、反射率、透明度、屈折率
- **平面**: 無限平面
  - プロパティ: 位置、法線、色、反射率
- **円柱**: 円柱オブジェクト
  - プロパティ: 位置、軸、半径、高さ、色、反射率

#### カメラノード
- **カメラ**: 視点設定
  - プロパティ: 位置、注視点、上方向ベクトル、視野角

#### ライトノード
- **ポイントライト**: 点光源
  - プロパティ: 位置、色、強度

#### シーンノード
- **シーン出力**: 最終的なシーン構成
  - 入力ソケット: カメラ、オブジェクト1-3、ライト1-2

#### 数学ノード
- **Vector3**: 3Dベクトル値
  - プロパティ: X、Y、Z

### ノードを接続する

ノード間を接続することで、データの流れを構築します。

#### 基本的な接続方法

1. 出力ソケット（ノードの右側の丸）をクリック
2. 入力ソケット（ノードの左側の丸）までドラッグ
3. マウスを離して接続を確定

**新機能**: ドラッグ＆ドロップで簡単に接続できます！

#### 接続ルール

- **オブジェクトノードの出力** → **シーンノードの「オブジェクト1」「オブジェクト2」「オブジェクト3」入力**
- **カメラノードの出力** → **シーンノードの「カメラ」入力**
- **ライトノードの出力** → **シーンノードの「ライト1」「ライト2」入力**
- **Vector3ノードの出力** → **オブジェクトノードの「位置」「法線」「軸」入力**

### ノードを移動する

1. ノードを左クリックしてドラッグ
2. 好きな位置に移動できます
3. 接続線も自動的に追従して更新されます

### ノードを削除する

2つの方法でノードを削除できます：

1. **Deleteキーで削除**:
   - ノードを選択してDeleteキーを押す
   
2. **プロパティパネルから削除**:
   - ノードを選択
   - 右パネルの「ノードを削除」ボタンをクリック

### ノードのプロパティを確認する

1. ノードをクリックして選択
2. 右パネルの「プロパティ」に以下の情報が表示されます：
   - ノード名
   - ノードタイプ
   - キャンバス上の位置
   - 入力ソケット一覧
   - 出力ソケット一覧

**注意**: プロパティ値の詳細編集機能は実装予定です。現在は情報の確認のみ可能です。

## シーンファイルの保存と読み込み

### 保存

1. メニューから **「ファイル」→「保存」** または **「名前を付けて保存」** を選択
2. ファイル名を入力して保存（拡張子: `.rtvs`）

### 読み込み

1. メニューから **「ファイル」→「開く」** を選択
2. 保存したシーンファイル（`.rtvs`）を選択

### 新規シーン

1. メニューから **「ファイル」→「新規シーン」** を選択
2. 確認ダイアログで「はい」を選択すると、現在のシーンがクリアされます

## レンダリング設定

レンダリングウィンドウで以下の設定が可能です：

### 解像度変更

ウィンドウ下部のドロップダウンから選択：
- 1280x720（デフォルト）
- 1920x1080
- 2560x1440
- 3840x2160

### レンダリング結果の保存

1. レンダリングウィンドウの **「保存」** ボタンをクリック
2. ファイル形式を選択（PNG、JPEG、BMP）
3. ファイル名を入力して保存

**注意**: 画像保存機能は現在実装中です。

## トラブルシューティング

### レンダリングが開始できない

**原因**: DirectX 12 DXRに対応していないGPUまたはドライバ

**解決策**:
1. グラフィックスドライバを最新版に更新
2. GPUがDirectX 12に対応しているか確認
3. Windows 10 2004以降であることを確認

### シーンが表示されない

**原因**: シーンノードにカメラとオブジェクトが接続されていない

**解決策**:
1. シーンノードが配置されているか確認
2. カメラノードの出力がシーンノードの「カメラ」入力に接続されているか確認
3. オブジェクトノードの出力がシーンノードの「オブジェクト1-3」に接続されているか確認

### ノードが見えない

**原因**: ノードがビューポートの外に配置されている

**解決策**:
1. マウス右ボタンでドラッグしてパン（移動）
2. マウスホイールでズームイン/ズームアウト
3. 「ファイル」→「開く」でサンプルシーンを再度読み込む

### 接続が作成できない

**原因**: 接続ルールに違反している

**解決策**:
1. 出力ソケット（右側）から入力ソケット（左側）の順でドラッグしているか確認
2. 同じノード内のソケット同士を接続していないか確認
3. ソケットの色が同じ（互換性のあるタイプ）か確認

## マウス＆キーボード操作

### マウス操作

| 操作 | 機能 |
|------|------|
| **左クリック + ドラッグ（ノード上）** | ノードを移動 |
| **左クリック + ドラッグ（ソケット上）** | 接続を作成 |
| **左クリック（空白）** | 選択解除 |
| **右クリック + ドラッグ** | キャンバスをパン（移動） |
| **マウスホイール** | ズーム（0.1倍 ～ 5.0倍） |

### キーボードショートカット

- **Delete**: 選択したノードを削除
- **Ctrl+S**: シーン保存（実装予定）
- **Ctrl+O**: シーン読み込み（実装予定）
- **Ctrl+N**: 新規シーン（実装予定）

## レンダリングのヒント

### 美しいレンダリング結果を得るために

1. **ライトの配置**: 
   - ライトの位置を調整して、オブジェクトに陰影をつける
   - 強度を調整して明るさを変更

2. **カメラの位置**:
   - カメラの位置と注視点を調整して、良い構図を探す
   - 視野角を変更して遠近感を調整

3. **マテリアル設定**:
   - 反射率を上げると鏡のような反射が得られる
   - 透明度と屈折率を調整してガラスのような表現が可能

4. **オブジェクトの配置**:
   - 平面を床として使用
   - 複数の球を配置してシーンを豊かに

## 次のステップ

1. サンプルシーンのパラメータを変更して実験してみる
2. ノードを追加してより複雑なシーンを作成
3. 独自のシーンを作成して保存

## 参考情報

- **プロジェクトドキュメント**: `README.md`
- **ビルドガイド**: `BUILD_GUIDE.md`
- **実装詳細**: `IMPLEMENTATION_SUMMARY.md`
